---
import Divider from '@components/core/Divider.astro';
import Title from '@components/core/Title.astro';
import Container from '@components/data/Container.astro';
import Tags from '@components/data/Tags.astro';
import Layout from '@layouts/Layout.astro';

import { getCollection, type CollectionEntry } from 'astro:content';

export async function getStaticPaths() {
  const posts = await getCollection('blog');
  return posts.map((post) => ({
    params: { slug: post.slug },
    props: { post },
  }));
}

interface Props {
  post: CollectionEntry<'blog'>;
}

const { post } = Astro.props;
const { Content } = await post.render();
---

<Layout title={post.data.title} description={post.data.description}>
  <Container>
    <span> Blog • Lucas Josino</span>
    <Title title={post.data.title} fontSize="2.5em" />
    <div class="post-info">
      <span>{post.data.published_at}</span> •
      <span>{post.data.category}</span> •
      <Tags tags={post.data.tags} />
    </div>
    {
      post.data.image && (
        <img
          src={post.data.image}
          alt={`Post - ${post.data.title}`}
          class="post-banner"
        />
      )
    }
    <Divider />
    <article class="post-content">
      <Content />
    </article>
  </Container>
</Layout>

<style>
  .post-banner {
    height: fit-content;
    width: 100%;
    border-radius: var(--border-radius);
    margin-top: 1rem;
  }

  .post-info {
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: row;
    gap: 1rem;
    text-wrap: nowrap;
  }

  .post-content {
    padding: 1rem;
    line-height: 1.85em;
  }
</style>
